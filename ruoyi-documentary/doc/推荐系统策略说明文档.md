# çºªå½•ç‰‡æ¨èç³»ç»Ÿç­–ç•¥è¯´æ˜æ–‡æ¡£

> æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0  
> ä½œè€…ï¼šèŒƒä½³å…´  
> æ›´æ–°æ—¥æœŸï¼š2024å¹´12æœˆ

---

## ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒæ¨èç®—æ³•](#2-æ ¸å¿ƒæ¨èç®—æ³•)
3. [æ¨èåœºæ™¯è¯¦è§£](#3-æ¨èåœºæ™¯è¯¦è§£)
4. [å†·å¯åŠ¨ç­–ç•¥](#4-å†·å¯åŠ¨ç­–ç•¥)
5. [ç”¨æˆ·è¡Œä¸ºæƒé‡é…ç½®](#5-ç”¨æˆ·è¡Œä¸ºæƒé‡é…ç½®)
6. [ç®—æ³•å‚æ•°é…ç½®](#6-ç®—æ³•å‚æ•°é…ç½®)
7. [æ•°æ®æµè½¬æµç¨‹](#7-æ•°æ®æµè½¬æµç¨‹)
8. [APIæ¥å£è¯´æ˜](#8-apiæ¥å£è¯´æ˜)
9. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#9-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
10. [åç»­ä¼˜åŒ–æ–¹å‘](#10-åç»­ä¼˜åŒ–æ–¹å‘)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯å±•ç¤ºå±‚                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ å…¶ä»–äººæ­¤æ—¶åœ¨çœ‹ â”‚    â”‚ çŒœä½ æ­¤æ—¶æƒ³çœ‹  â”‚    â”‚   æˆ‘çš„æ”¶è—    â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ¨èæœåŠ¡å±‚ (RecommendationService)          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚  ååŒè¿‡æ»¤æ¨èå¼•æ“ (DocumentaryCollaborativeFiltering)  â”‚    â”‚
â”‚    â”‚  - ç”¨æˆ·ç›¸ä¼¼åº¦è®¡ç®—                                      â”‚    â”‚
â”‚    â”‚  - TOP N æ¨èç”Ÿæˆ                                      â”‚    â”‚
â”‚    â”‚  - çƒ­é—¨é™çº§ç­–ç•¥                                        â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å±‚                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ ç”¨æˆ·è¡Œä¸ºè¡¨    â”‚    â”‚  çºªå½•ç‰‡è¡¨     â”‚    â”‚  è¯„è®ºè¡¨      â”‚    â”‚
â”‚    â”‚ (drs_storeup) â”‚    â”‚(drs_documentary)â”‚   â”‚(drs_comment) â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | æè¿° | æ¨èæ•°é‡ |
|---------|------|---------|
| å…¶ä»–äººæ­¤æ—¶åœ¨çœ‹ | åŸºäºæ—¶æ®µçš„ä¸ªæ€§åŒ–æ¨è | æœ€å¤š30æ¡ |
| çŒœä½ æ­¤æ—¶æƒ³çœ‹ | åŸºäºé«˜è¯„åˆ†çš„ä¸ªæ€§åŒ–æ¨è | æœ€å¤š30æ¡ |
| ååŒè¿‡æ»¤æ¨è | åŸºäºç”¨æˆ·è¡Œä¸ºçš„ååŒè¿‡æ»¤ | æœ€å¤š100æ¡ |

---

## 2. æ ¸å¿ƒæ¨èç®—æ³•

### 2.1 åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³• (User-Based Collaborative Filtering)

#### 2.1.1 ç®—æ³•åŸç†

ååŒè¿‡æ»¤æ˜¯ä¸€ç§åŸºäºç”¨æˆ·è¡Œä¸ºæ•°æ®çš„æ¨èç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**ç›¸ä¼¼çš„ç”¨æˆ·å¯èƒ½å–œæ¬¢ç›¸ä¼¼çš„å†…å®¹**ã€‚

```
ç®—æ³•æµç¨‹ï¼š
1. æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼ˆæŸ¥çœ‹ã€è®¿é—®ã€æ”¶è—ï¼‰
2. æ„å»ºç”¨æˆ·-çºªå½•ç‰‡è¯„åˆ†çŸ©é˜µ
3. è®¡ç®—ç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼ˆä½™å¼¦ç›¸ä¼¼åº¦ï¼‰
4. æ‰¾å‡ºä¸ç›®æ ‡ç”¨æˆ·æœ€ç›¸ä¼¼çš„Kä¸ªç”¨æˆ·
5. æ ¹æ®ç›¸ä¼¼ç”¨æˆ·çš„è¡Œä¸ºé¢„æµ‹ç›®æ ‡ç”¨æˆ·çš„åå¥½
6. ç”ŸæˆTOP Næ¨èåˆ—è¡¨
```

#### 2.1.2 ç”¨æˆ·ç›¸ä¼¼åº¦è®¡ç®—

ä½¿ç”¨**ä½™å¼¦ç›¸ä¼¼åº¦**è®¡ç®—ä¸¤ä¸ªç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ï¼š

```
ç›¸ä¼¼åº¦å…¬å¼ï¼š
similarity(user1, user2) = å…±åŒè¯„åˆ†æ•° / sqrt(user1è¯„åˆ†æ•° Ã— user2è¯„åˆ†æ•°)
```

**ä»£ç å®ç°ï¼š**
```java
public double calculateSimilarity(Long user1, Long user2) {
    // è·å–ä¸¤ä¸ªç”¨æˆ·çš„è¯„åˆ†æ•°é‡
    Map<Long, Double> ratings1 = userRatings.get(user1);
    Map<Long, Double> ratings2 = userRatings.get(user2);
    
    // è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
    long coRatingCount = this.coRatingMatrix[idx1][idx2];
    double denominator = Math.sqrt(ratings1.size() * ratings2.size());
    
    return denominator > 0 ? coRatingCount / denominator : 0.0;
}
```

#### 2.1.3 æ¨èåˆ†æ•°è®¡ç®—

å¯¹äºç›®æ ‡ç”¨æˆ·æœªè§‚çœ‹çš„æ¯ä¸ªçºªå½•ç‰‡ï¼Œè®¡ç®—æ¨èåˆ†æ•°ï¼š

```
æ¨èåˆ†æ•°å…¬å¼ï¼š
score(documentary) = Î£ (ç›¸ä¼¼ç”¨æˆ·çš„è¯„åˆ† Ã— ç›¸ä¼¼åº¦)
```

**ç¤ºä¾‹ï¼š**
```
ç›®æ ‡ç”¨æˆ·Aè¦æ¨èçºªå½•ç‰‡Xï¼š
- ç›¸ä¼¼ç”¨æˆ·Bï¼ˆç›¸ä¼¼åº¦0.8ï¼‰å¯¹Xè¯„åˆ†5.0 â†’ è´¡çŒ®åˆ†æ•°ï¼š5.0 Ã— 0.8 = 4.0
- ç›¸ä¼¼ç”¨æˆ·Cï¼ˆç›¸ä¼¼åº¦0.6ï¼‰å¯¹Xè¯„åˆ†4.0 â†’ è´¡çŒ®åˆ†æ•°ï¼š4.0 Ã— 0.6 = 2.4
- ç›¸ä¼¼ç”¨æˆ·Dï¼ˆç›¸ä¼¼åº¦0.4ï¼‰å¯¹Xè¯„åˆ†3.0 â†’ è´¡çŒ®åˆ†æ•°ï¼š3.0 Ã— 0.4 = 1.2

çºªå½•ç‰‡Xçš„æ€»æ¨èåˆ†æ•° = 4.0 + 2.4 + 1.2 = 7.6
```

---

## 3. æ¨èåœºæ™¯è¯¦è§£

### 3.1 åœºæ™¯ä¸€ï¼šå…¶ä»–äººæ­¤æ—¶åœ¨çœ‹

**åŠŸèƒ½æè¿°ï¼š** æ ¹æ®å½“å‰æ—¶æ®µï¼Œæ¨èé€‚åˆè¯¥æ—¶æ®µè§‚çœ‹çš„çºªå½•ç‰‡ã€‚

**æ¨èé€»è¾‘ï¼š**

```
1. è·å–å½“å‰åŒ—äº¬æ—¶é—´ï¼Œç¡®å®šæ‰€å±æ—¶æ®µ
2. è°ƒç”¨ååŒè¿‡æ»¤ç®—æ³•è·å–TOP 100ä¸ªæ€§åŒ–æ¨è
3. ç­›é€‰å‡ºä¸å½“å‰æ—¶æ®µåŒ¹é…çš„çºªå½•ç‰‡ï¼ˆæœ€å¤š30æ¡ï¼‰
4. å¦‚æœä¸è¶³30æ¡ï¼Œå¯ç”¨å†·å¯åŠ¨é™çº§ç­–ç•¥è¡¥å……çƒ­é—¨çºªå½•ç‰‡
```

**æ—¶æ®µåˆ’åˆ†ï¼š**

| æ—¶æ®µ | æ—¶é—´èŒƒå›´ | é€‚ç”¨åœºæ™¯ |
|-----|---------|---------|
| æ·±å¤œæ¡£ | 00:00-06:00 | æ·±å¤œå‰§åœºã€çºªå½•ç‰‡ä¸“åœº |
| ä¸Šåˆæ¡£ | 06:00-12:00 | æ™¨é—´æ–°é—»ã€æ•™è‚²çºªå½•ç‰‡ |
| ä¸‹åˆæ¡£ | 12:00-18:00 | åˆé—´ä¼‘é—²ã€ç§‘æ™®çºªå½•ç‰‡ |
| æ™šé—´æ¡£ | 18:00-24:00 | é»„é‡‘æ—¶æ®µã€çƒ­é—¨çºªå½•ç‰‡ |

**ä»£ç å®ç°ï¼š**
```java
public List<Documentary> getWatchingNowRecommendations(Long userId) {
    // 1. è·å–å½“å‰æ—¶æ®µ
    String currentTimePeriod = getCurrentTimePeriod();
    
    // 2. è·å–ååŒè¿‡æ»¤æ¨è
    List<Documentary> allRecommendations = recommendDocumentaries(userId, 100);
    
    // 3. ç­›é€‰å½“å‰æ—¶æ®µçš„çºªå½•ç‰‡
    List<Documentary> matchingDocumentaries = allRecommendations.stream()
        .filter(doc -> currentTimePeriod.equals(doc.getBroadcastTime()))
        .limit(30)
        .collect(Collectors.toList());
    
    // 4. å†·å¯åŠ¨é™çº§ï¼šè¡¥å……çƒ­é—¨çºªå½•ç‰‡
    if (matchingDocumentaries.size() < 30) {
        List<Documentary> hotDocs = getHotDocumentariesByTimePeriod(currentTimePeriod, 30 - matchingDocumentaries.size());
        // å»é‡åæ·»åŠ 
    }
    
    return matchingDocumentaries;
}
```

### 3.2 åœºæ™¯äºŒï¼šçŒœä½ æ­¤æ—¶æƒ³çœ‹

**åŠŸèƒ½æè¿°ï¼š** åŸºäºç”¨æˆ·åå¥½ï¼Œæ¨èé«˜è¯„åˆ†çš„çºªå½•ç‰‡ã€‚

**æ¨èé€»è¾‘ï¼š**

```
1. è°ƒç”¨ååŒè¿‡æ»¤ç®—æ³•è·å–TOP 100ä¸ªæ€§åŒ–æ¨è
2. ç­›é€‰å‡ºæœ‰è¯„åˆ†ä¸”è¯„åˆ†å¤§äº0çš„çºªå½•ç‰‡
3. æŒ‰è¯„åˆ†é™åºæ’åºï¼Œå–å‰30æ¡
4. å¦‚æœä¸è¶³30æ¡ï¼Œå¯ç”¨å†·å¯åŠ¨é™çº§ç­–ç•¥è¡¥å……å…¨å±€é«˜è¯„åˆ†çºªå½•ç‰‡
```

**ä»£ç å®ç°ï¼š**
```java
public List<Documentary> getTopRatedRecommendations(Long userId) {
    // 1. è·å–ååŒè¿‡æ»¤æ¨è
    List<Documentary> allRecommendations = recommendDocumentaries(userId, 100);
    
    // 2. æŒ‰è¯„åˆ†æ’åº
    List<Documentary> topRatedDocumentaries = allRecommendations.stream()
        .filter(doc -> doc.getRating() != null && doc.getRating() > 0)
        .sorted((d1, d2) -> d2.getRating().compareTo(d1.getRating()))
        .limit(30)
        .collect(Collectors.toList());
    
    // 3. å†·å¯åŠ¨é™çº§ï¼šè¡¥å……å…¨å±€é«˜è¯„åˆ†çºªå½•ç‰‡
    if (topRatedDocumentaries.size() < 30) {
        List<Documentary> globalTopRated = getGlobalTopRatedDocumentaries(30 - topRatedDocumentaries.size());
        // å»é‡åæ·»åŠ 
    }
    
    return topRatedDocumentaries;
}
```

---

## 4. å†·å¯åŠ¨ç­–ç•¥

### 4.1 ä»€ä¹ˆæ˜¯å†·å¯åŠ¨é—®é¢˜

å†·å¯åŠ¨æ˜¯æ¨èç³»ç»Ÿé¢ä¸´çš„å¸¸è§é—®é¢˜ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

| ç±»å‹ | æè¿° | åº”å¯¹ç­–ç•¥ |
|-----|------|---------|
| æ–°ç”¨æˆ·å†·å¯åŠ¨ | æ–°ç”¨æˆ·æ²¡æœ‰è¡Œä¸ºæ•°æ® | æ¨èçƒ­é—¨çºªå½•ç‰‡ |
| æ–°ç‰©å“å†·å¯åŠ¨ | æ–°çºªå½•ç‰‡æ²¡æœ‰è¢«è¯„ä»· | åŸºäºå†…å®¹çš„æ¨è |
| ç³»ç»Ÿå†·å¯åŠ¨ | ç³»ç»ŸåˆæœŸæ•°æ®ç¨€ç– | å¤šç­–ç•¥ç»„åˆ |

### 4.2 æœ¬ç³»ç»Ÿçš„å†·å¯åŠ¨è§£å†³æ–¹æ¡ˆ

#### 4.2.1 æ–°ç”¨æˆ·å†·å¯åŠ¨

å½“ç”¨æˆ·æ²¡æœ‰è¡Œä¸ºæ•°æ®æˆ–æ‰¾ä¸åˆ°ç›¸ä¼¼ç”¨æˆ·æ—¶ï¼Œè¿”å›**çƒ­é—¨çºªå½•ç‰‡**ï¼š

```java
private List<Long> getHotDocumentaries(int topN) {
    // ç»Ÿè®¡æ¯ä¸ªçºªå½•ç‰‡è¢«å¤šå°‘ç”¨æˆ·è¯„åˆ†ï¼ˆçƒ­åº¦ï¼‰
    Map<Long, Integer> documentaryPopularity = new HashMap<>();
    for (Long documentaryId : documentaryUsers.keySet()) {
        documentaryPopularity.put(documentaryId, documentaryUsers.get(documentaryId).size());
    }
    
    // æŒ‰çƒ­åº¦é™åºæ’åº
    return documentaryPopularity.entrySet()
        .stream()
        .sorted(Map.Entry.<Long, Integer>comparingByValue().reversed())
        .limit(topN)
        .map(Map.Entry::getKey)
        .collect(Collectors.toList());
}
```

#### 4.2.2 æ—¶æ®µæ¨èå†·å¯åŠ¨

å½“æŸæ—¶æ®µçš„ä¸ªæ€§åŒ–æ¨èä¸è¶³æ—¶ï¼Œè¡¥å……è¯¥æ—¶æ®µçš„çƒ­é—¨çºªå½•ç‰‡ï¼š

```java
private List<Documentary> getHotDocumentariesByTimePeriod(String timePeriod, int limit) {
    // æŸ¥è¯¢è¯¥æ—¶æ®µå®¡æ ¸é€šè¿‡çš„çºªå½•ç‰‡
    Documentary query = new Documentary();
    query.setStatus(2);
    query.setBroadcastTime(timePeriod);
    List<Documentary> documentaries = documentaryMapper.getAllDocumentaries(query);
    
    // å¦‚æœè¯¥æ—¶æ®µæ²¡æœ‰çºªå½•ç‰‡ï¼Œè·å–å…¨å±€çƒ­é—¨
    if (documentaries.isEmpty()) {
        Documentary globalQuery = new Documentary();
        globalQuery.setStatus(2);
        documentaries = documentaryMapper.getAllDocumentaries(globalQuery);
    }
    
    // æŒ‰æ’­æ”¾é‡æ’åº
    return documentaries.stream()
        .sorted((d1, d2) -> d2.getPlayCount().compareTo(d1.getPlayCount()))
        .limit(limit)
        .collect(Collectors.toList());
}
```

#### 4.2.3 é«˜è¯„åˆ†æ¨èå†·å¯åŠ¨

å½“é«˜è¯„åˆ†ä¸ªæ€§åŒ–æ¨èä¸è¶³æ—¶ï¼Œè¡¥å……å…¨å±€é«˜è¯„åˆ†çºªå½•ç‰‡ï¼š

```java
private List<Documentary> getGlobalTopRatedDocumentaries(int limit) {
    Documentary query = new Documentary();
    query.setStatus(2);
    List<Documentary> documentaries = documentaryMapper.getAllDocumentaries(query);
    
    // ä¼˜å…ˆæŒ‰è¯„åˆ†æ’åºï¼Œè¯„åˆ†ç›¸åŒåˆ™æŒ‰ç‚¹èµæ•°æ’åº
    return documentaries.stream()
        .sorted((d1, d2) -> {
            if (d1.getRating() != null && d2.getRating() != null) {
                int ratingCompare = d2.getRating().compareTo(d1.getRating());
                if (ratingCompare != 0) return ratingCompare;
            }
            // è¯„åˆ†ç›¸åŒï¼ŒæŒ‰ç‚¹èµæ•°æ’åº
            return d2.getLikeCount().compareTo(d1.getLikeCount());
        })
        .limit(limit)
        .collect(Collectors.toList());
}
```

---

## 5. ç”¨æˆ·è¡Œä¸ºæƒé‡é…ç½®

### 5.1 è¡Œä¸ºç±»å‹å®šä¹‰

ç³»ç»Ÿè®°å½•ä¸‰ç§ç”¨æˆ·è¡Œä¸ºï¼Œæ¯ç§è¡Œä¸ºä»£è¡¨ä¸åŒçš„å…´è¶£å¼ºåº¦ï¼š

| è¡Œä¸ºç±»å‹ | ActionTypeå€¼ | æè¿° | è§¦å‘åœºæ™¯ |
|---------|-------------|------|---------|
| æŸ¥çœ‹ | 1 | ç”¨æˆ·æµè§ˆçºªå½•ç‰‡ | è¿›å…¥çºªå½•ç‰‡è¯¦æƒ…é¡µ |
| è®¿é—® | 2 | ç”¨æˆ·è®¿é—®è¯¦æƒ…é“¾æ¥ | ç‚¹å‡»å¤–éƒ¨é“¾æ¥ |
| æ”¶è— | 3 | ç”¨æˆ·æ”¶è—çºªå½•ç‰‡ | ç‚¹å‡»æ”¶è—æŒ‰é’® |

### 5.2 è¡Œä¸ºæƒé‡é…ç½®

ä¸åŒè¡Œä¸ºå¯¹ç”¨æˆ·åå¥½çš„è´¡çŒ®ä¸åŒï¼Œæƒé‡è®¾ç½®å¦‚ä¸‹ï¼š

| è¡Œä¸ºç±»å‹ | æƒé‡å€¼ | æƒé‡è¯´æ˜ |
|---------|-------|---------|
| æŸ¥çœ‹ (VIEW) | 1.0 | åŸºç¡€å…´è¶£ï¼Œæƒé‡æœ€ä½ |
| è®¿é—® (ACCESS) | 3.0 | è¾ƒå¼ºå…´è¶£ï¼Œæƒé‡ä¸­ç­‰ |
| æ”¶è— (COLLECT) | 5.0 | å¼ºçƒˆå…´è¶£ï¼Œæƒé‡æœ€é«˜ |

**ä»£ç é…ç½®ï¼š**
```java
// ç”¨æˆ·è¡Œä¸ºè¯„åˆ†æƒé‡é…ç½®
private static final double VIEW_WEIGHT = 1.0;      // æŸ¥çœ‹è¡Œä¸ºæƒé‡
private static final double ACCESS_WEIGHT = 3.0;    // è®¿é—®é“¾æ¥æƒé‡
private static final double COLLECT_WEIGHT = 5.0;   // æ”¶è—è¡Œä¸ºæƒé‡

public static double getActionWeight(int actionType) {
    switch (actionType) {
        case 1: return VIEW_WEIGHT;   // æŸ¥çœ‹
        case 2: return ACCESS_WEIGHT; // è®¿é—®
        case 3: return COLLECT_WEIGHT; // æ”¶è—
        default: return 1.0;
    }
}
```

### 5.3 è¯„åˆ†çŸ©é˜µæ„å»º

ç”¨æˆ·å¯¹çºªå½•ç‰‡çš„æœ€ç»ˆè¯„åˆ† = å„è¡Œä¸ºæƒé‡çš„ç´¯åŠ ï¼š

```java
private Map<Long, Map<Long, Double>> buildUserRatingsMatrix(List<Storeup> storeups) {
    Map<Long, Map<Long, Double>> userRatings = new HashMap<>();
    
    for (Storeup storeup : storeups) {
        Long userId = storeup.getUserId();
        Long documentaryId = storeup.getDocumentaryId();
        Integer actionType = storeup.getActionType();
        
        // è·å–è¡Œä¸ºæƒé‡
        double weight = DocumentaryCollaborativeFiltering.getActionWeight(actionType);
        
        // ç´¯åŠ è¯„åˆ†ï¼ˆåŒä¸€ç”¨æˆ·å¯¹åŒä¸€çºªå½•ç‰‡çš„å¤šæ¬¡è¡Œä¸ºä¼šç´¯åŠ ï¼‰
        userRatings
            .computeIfAbsent(userId, k -> new HashMap<>())
            .merge(documentaryId, weight, Double::sum);
    }
    
    return userRatings;
}
```

**ç¤ºä¾‹è®¡ç®—ï¼š**
```
ç”¨æˆ·Aå¯¹çºªå½•ç‰‡Xçš„è¡Œä¸ºè®°å½•ï¼š
- æŸ¥çœ‹ 3æ¬¡ â†’ 3 Ã— 1.0 = 3.0
- è®¿é—® 1æ¬¡ â†’ 1 Ã— 3.0 = 3.0
- æ”¶è— 1æ¬¡ â†’ 1 Ã— 5.0 = 5.0

ç”¨æˆ·Aå¯¹çºªå½•ç‰‡Xçš„æœ€ç»ˆè¯„åˆ† = 3.0 + 3.0 + 5.0 = 11.0
```

### 5.4 è¯„åˆ†å½’ä¸€åŒ–

ä¸ºé¿å…æ´»è·ƒç”¨æˆ·è¯„åˆ†è¿‡é«˜å½±å“æ¨èæ•ˆæœï¼Œå¯¹è¯„åˆ†è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼š

```java
private void normalizeRatings(Map<Long, Map<Long, Double>> userRatings) {
    for (Map<Long, Double> ratings : userRatings.values()) {
        // è®¡ç®—ç”¨æˆ·çš„æœ€å¤§è¯„åˆ†
        double maxRating = ratings.values().stream()
            .max(Double::compareTo)
            .orElse(1.0);
        
        // å½’ä¸€åŒ–åˆ°0-10çš„èŒƒå›´
        if (maxRating > 10.0) {
            for (Map.Entry<Long, Double> entry : ratings.entrySet()) {
                entry.setValue(entry.getValue() / maxRating * 10.0);
            }
        }
    }
}
```

---

## 6. ç®—æ³•å‚æ•°é…ç½®

### 6.1 æ ¸å¿ƒå‚æ•°

| å‚æ•°å | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|-------|------|
| SIMILARITY_THRESHOLD | 0.05 | ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œè¿‡æ»¤ä½ç›¸ä¼¼åº¦ç”¨æˆ· |
| DEFAULT_RECOMMENDATIONS | 100 | é»˜è®¤æ¨èæ•°é‡ |
| MAX_SIMILAR_USERS | 30 | æœ€å¤§ç›¸ä¼¼ç”¨æˆ·æ•°é‡ |

### 6.2 å‚æ•°è¯´æ˜

#### SIMILARITY_THRESHOLD (ç›¸ä¼¼åº¦é˜ˆå€¼)
```
ä½œç”¨ï¼šè¿‡æ»¤æ‰ä¸ç›®æ ‡ç”¨æˆ·ç›¸ä¼¼åº¦è¿‡ä½çš„ç”¨æˆ·
å–å€¼èŒƒå›´ï¼š0.0 - 1.0
å»ºè®®å€¼ï¼š0.05 - 0.2
- å€¼è¶Šå°ï¼šè€ƒè™‘æ›´å¤šç”¨æˆ·ï¼Œæ¨èæ›´å¤šæ ·ä½†å¯èƒ½ä¸ç²¾å‡†
- å€¼è¶Šå¤§ï¼šåªè€ƒè™‘é«˜ç›¸ä¼¼åº¦ç”¨æˆ·ï¼Œæ¨èæ›´ç²¾å‡†ä½†å¯èƒ½æ•°é‡ä¸è¶³
```

#### MAX_SIMILAR_USERS (æœ€å¤§ç›¸ä¼¼ç”¨æˆ·æ•°)
```
ä½œç”¨ï¼šé™åˆ¶å‚ä¸æ¨èè®¡ç®—çš„ç›¸ä¼¼ç”¨æˆ·æ•°é‡
å»ºè®®å€¼ï¼š20 - 50
- å€¼è¶Šå°ï¼šè®¡ç®—é€Ÿåº¦å¿«ï¼Œä½†æ¨èå¤šæ ·æ€§é™ä½
- å€¼è¶Šå¤§ï¼šæ¨èæ›´å¤šæ ·ï¼Œä½†è®¡ç®—å¼€é”€å¢åŠ 
```

---

## 7. æ•°æ®æµè½¬æµç¨‹

### 7.1 æ¨èæ¨¡å‹åˆå§‹åŒ–æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç³»ç»Ÿå¯åŠ¨ (@PostConstruct)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä»æ•°æ®åº“åŠ è½½æ‰€æœ‰ç”¨æˆ·è¡Œä¸ºè®°å½• (drs_storeup)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ„å»ºç”¨æˆ·-çºªå½•ç‰‡è¯„åˆ†çŸ©é˜µ                        â”‚
â”‚    - éå†è¡Œä¸ºè®°å½•                                               â”‚
â”‚    - æ ¹æ®è¡Œä¸ºç±»å‹è®¡ç®—æƒé‡                                        â”‚
â”‚    - ç´¯åŠ åŒä¸€ç”¨æˆ·å¯¹åŒä¸€çºªå½•ç‰‡çš„è¯„åˆ†                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       è¯„åˆ†å½’ä¸€åŒ–å¤„ç†                             â”‚
â”‚    - å°†è¯„åˆ†æ ‡å‡†åŒ–åˆ°0-10èŒƒå›´                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åˆ›å»ºååŒè¿‡æ»¤æ¨èå¼•æ“å®ä¾‹                         â”‚
â”‚    - æ„å»ºçºªå½•ç‰‡-ç”¨æˆ·å€’æ’è¡¨                                       â”‚
â”‚    - æ„å»ºç”¨æˆ·å…±åŒè¯„åˆ†çŸ©é˜µ                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ¨èæ¨¡å‹åˆå§‹åŒ–å®Œæˆ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 æ¨èè¯·æ±‚å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·è¯·æ±‚æ¨è (userId)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è¡Œä¸ºæ•°æ®                          â”‚
â”‚                  æœ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ æ—                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                    â”‚
                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è®¡ç®—ä¸å…¶ä»–ç”¨æˆ·çš„ç›¸ä¼¼åº¦  â”‚    â”‚    è¿”å›çƒ­é—¨çºªå½•ç‰‡æ¨è    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç­›é€‰ç›¸ä¼¼åº¦å¤§äºé˜ˆå€¼çš„ç”¨æˆ·                             â”‚
â”‚                  æœ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ æ—                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                    â”‚
                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å–TOP Kä¸ªç›¸ä¼¼ç”¨æˆ·     â”‚    â”‚    è¿”å›çƒ­é—¨çºªå½•ç‰‡æ¨è    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               åŸºäºç›¸ä¼¼ç”¨æˆ·è¡Œä¸ºè®¡ç®—æ¨èåˆ†æ•°                        â”‚
â”‚    æ¨èåˆ†æ•° = Î£(ç›¸ä¼¼ç”¨æˆ·è¯„åˆ† Ã— ç›¸ä¼¼åº¦)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æŒ‰æ¨èåˆ†æ•°é™åºæ’åºï¼Œè¿”å›TOP Næ¨è                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. APIæ¥å£è¯´æ˜

### 8.1 æ¨èç›¸å…³æ¥å£

| æ¥å£ | æ–¹æ³• | æè¿° |
|-----|------|------|
| `/documentary/recommendation/watchingNow` | GET | å…¶ä»–äººæ­¤æ—¶åœ¨çœ‹ |
| `/documentary/recommendation/topRated` | GET | çŒœä½ æ­¤æ—¶æƒ³çœ‹ |
| `/documentary/recommendation/refresh` | POST | åˆ·æ–°æ¨èæ¨¡å‹ |

### 8.2 æ¥å£è¯¦æƒ…

#### è·å–"å…¶ä»–äººæ­¤æ—¶åœ¨çœ‹"æ¨è

```
GET /documentary/recommendation/watchingNow

å“åº”ç¤ºä¾‹ï¼š
{
    "code": 200,
    "msg": "æ“ä½œæˆåŠŸ",
    "data": [
        {
            "documentaryId": 1,
            "documentaryName": "åœ°çƒè„‰åŠ¨",
            "documentaryType": "è‡ªç„¶",
            "rating": 9.5,
            "broadcastTime": "18:00-24:00",
            ...
        }
    ]
}
```

#### è·å–"çŒœä½ æ­¤æ—¶æƒ³çœ‹"æ¨è

```
GET /documentary/recommendation/topRated

å“åº”ç¤ºä¾‹ï¼š
{
    "code": 200,
    "msg": "æ“ä½œæˆåŠŸ",
    "data": [
        {
            "documentaryId": 2,
            "documentaryName": "äººç”Ÿä¸ƒå¹´",
            "documentaryType": "ç¤¾ä¼š",
            "rating": 9.8,
            ...
        }
    ]
}
```

---

## 9. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 9.1 å·²å®ç°çš„ä¼˜åŒ–

| ä¼˜åŒ–ç­–ç•¥ | æè¿° | æ•ˆæœ |
|---------|------|-----|
| å€’æ’è¡¨ç´¢å¼• | æ„å»ºçºªå½•ç‰‡-ç”¨æˆ·å€’æ’è¡¨ | åŠ é€Ÿç›¸ä¼¼åº¦è®¡ç®— |
| å…±åŒè¯„åˆ†çŸ©é˜µ | é¢„è®¡ç®—ç”¨æˆ·å…±åŒè¯„åˆ†æ•° | é¿å…é‡å¤è®¡ç®— |
| ç›¸ä¼¼åº¦é˜ˆå€¼è¿‡æ»¤ | è¿‡æ»¤ä½ç›¸ä¼¼åº¦ç”¨æˆ· | å‡å°‘æ— æ•ˆè®¡ç®— |
| ç›¸ä¼¼ç”¨æˆ·æ•°é‡é™åˆ¶ | åªå–TOP Kç›¸ä¼¼ç”¨æˆ· | æ§åˆ¶è®¡ç®—è§„æ¨¡ |
| æ¨¡å‹é¢„åŠ è½½ | ç³»ç»Ÿå¯åŠ¨æ—¶åˆå§‹åŒ–æ¨¡å‹ | é¿å…é¦–æ¬¡è¯·æ±‚å»¶è¿Ÿ |

### 9.2 å»ºè®®çš„ä¼˜åŒ–æ–¹å‘

| ä¼˜åŒ–æ–¹å‘ | æè¿° | é¢„æœŸæ”¶ç›Š |
|---------|------|---------|
| å¢é‡æ›´æ–° | æ–°è¡Œä¸ºä¸é‡å»ºæ•´ä¸ªæ¨¡å‹ | å‡å°‘æ¨¡å‹åˆ·æ–°æ—¶é—´ |
| ç¼“å­˜æ¨èç»“æœ | Redisç¼“å­˜ç”¨æˆ·æ¨è | é™ä½é‡å¤è®¡ç®— |
| åˆ†å¸ƒå¼è®¡ç®— | Spark/Flinkè®¡ç®— | æ”¯æŒæ›´å¤§æ•°æ®è§„æ¨¡ |
| å®æ—¶æ¨è | æµå¼å¤„ç†ç”¨æˆ·è¡Œä¸º | æ¨èæ›´åŠæ—¶ |

---

## 10. åç»­ä¼˜åŒ–æ–¹å‘

### 10.1 ç®—æ³•ä¼˜åŒ–

- [ ] **å¼•å…¥çŸ©é˜µåˆ†è§£**ï¼šä½¿ç”¨SVD/ALSç­‰ç®—æ³•æå‡æ¨èç²¾åº¦
- [ ] **æ··åˆæ¨è**ï¼šç»“åˆååŒè¿‡æ»¤å’ŒåŸºäºå†…å®¹çš„æ¨è
- [ ] **æ·±åº¦å­¦ä¹ **ï¼šä½¿ç”¨ç¥ç»ç½‘ç»œå­¦ä¹ ç”¨æˆ·åå¥½è¡¨ç¤º
- [ ] **å¤šç›®æ ‡ä¼˜åŒ–**ï¼šåŒæ—¶è€ƒè™‘ç²¾å‡†åº¦ã€å¤šæ ·æ€§ã€æ–°é¢–æ€§

### 10.2 åŠŸèƒ½æ‰©å±•

- [ ] **æ¨èç†ç”±**ï¼šå±•ç¤º"å› ä¸ºä½ å–œæ¬¢Xï¼Œæ¨èY"
- [ ] **è´Ÿåé¦ˆ**ï¼šæ”¯æŒ"ä¸æ„Ÿå…´è¶£"æ ‡è®°
- [ ] **å®æ—¶ä¸ªæ€§åŒ–**ï¼šæ ¹æ®å½“å‰ä¼šè¯è¡Œä¸ºè°ƒæ•´æ¨è
- [ ] **A/Bæµ‹è¯•**ï¼šæ”¯æŒå¤šç­–ç•¥å¯¹æ¯”å®éªŒ

### 10.3 è¿è¥æ”¯æŒ

- [ ] **æ¨èæŠ¥è¡¨**ï¼šCTRã€è¦†ç›–ç‡ç­‰æŒ‡æ ‡ç›‘æ§
- [ ] **äººå·¥å¹²é¢„**ï¼šæ”¯æŒè¿è¥äººå‘˜ç½®é¡¶/ä¸‹çº¿æ¨è
- [ ] **å®šæ—¶ä»»åŠ¡**ï¼šè‡ªåŠ¨åˆ·æ–°æ¨èæ¨¡å‹
- [ ] **æ¨èæ—¥å¿—**ï¼šè®°å½•æ¨èè¿‡ç¨‹ä¾¿äºåˆ†æ

---

## é™„å½•

### A. ç›¸å…³ä»£ç æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|------|
| `ruoyi-documentary/src/main/java/com/ruoyi/documentary/service/impl/RecommendationServiceImpl.java` | æ¨èæœåŠ¡å®ç° |
| `ruoyi-common/src/main/java/com/ruoyi/common/utils/recommend/DocumentaryCollaborativeFiltering.java` | ååŒè¿‡æ»¤ç®—æ³• |
| `ruoyi-documentary/src/main/java/com/ruoyi/documentary/service/RecommendationService.java` | æ¨èæœåŠ¡æ¥å£ |
| `ruoyi-admin/src/main/java/com/ruoyi/web/controller/documentary/RecommendationController.java` | æ¨èAPIæ§åˆ¶å™¨ |

### B. æ•°æ®åº“è¡¨ç»“æ„

#### ç”¨æˆ·è¡Œä¸ºè¡¨ (drs_storeup)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| storeup_id | bigint | ä¸»é”® |
| user_id | bigint | ç”¨æˆ·ID |
| documentary_id | bigint | çºªå½•ç‰‡ID |
| action_type | int | è¡Œä¸ºç±»å‹(1-æŸ¥çœ‹,2-è®¿é—®,3-æ”¶è—) |
| action_time | datetime | è¡Œä¸ºæ—¶é—´ |

#### çºªå½•ç‰‡è¡¨ (drs_documentary)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| documentary_id | bigint | ä¸»é”® |
| documentary_name | varchar | çºªå½•ç‰‡åç§° |
| documentary_type | varchar | ç±»å‹ |
| release_year | int | å‘å¸ƒå¹´ä»½ |
| rating | double | è¯„åˆ† |
| play_count | bigint | æ’­æ”¾é‡ |
| like_count | bigint | ç‚¹èµæ•° |
| broadcast_time | varchar | æ’­æ”¾æ—¶æ®µ |
| status | int | å®¡æ ¸çŠ¶æ€ |

---

> ğŸ“ **æ–‡æ¡£ç»´æŠ¤è¯´æ˜**  
> æœ¬æ–‡æ¡£åº”éšç³»ç»Ÿæ›´æ–°åŒæ­¥ç»´æŠ¤ï¼Œç¡®ä¿ä¸å®é™…ä»£ç å®ç°ä¸€è‡´ã€‚

