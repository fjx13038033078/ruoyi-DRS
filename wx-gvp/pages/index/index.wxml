<!--index.wxml-->
<navigation-bar title="不良反应信息收集" back="{{false}}" color="white" background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- 顶部用户卡片 -->
    <view class="header-card" wx:if="{{isLogin && userInfo}}">
      <view class="header-bg">
        <view class="bg-circle bg-circle-1"></view>
        <view class="bg-circle bg-circle-2"></view>
        <view class="bg-circle bg-circle-3"></view>
      </view>
      
      <view class="header-content">
        <!-- 问候语 -->
        <view class="greeting-section">
          <text class="greeting-text">你好，</text>
          <text class="user-name-large">{{userInfo.nickName || userInfo.userName || '患者'}}</text>
        </view>
        
        <!-- 用户信息区域 -->
        <view class="user-info-section">
          <view class="user-avatar-large">
            <!-- 显示头像：优先用户头像，其次默认头像 -->
            <image 
              src="{{userInfo.avatar || '/assets/images/profile.jpg'}}" 
              class="avatar-image"
              mode="aspectFill"
            ></image>
          </view>
          
          <view class="user-details">
            <view class="detail-row">
              <text class="detail-label">身份</text>
              <text class="detail-value">患者用户</text>
            </view>
            <view class="detail-row">
              <text class="detail-label">状态</text>
              <view class="status-badge">
                <view class="status-dot-new"></view>
                <text class="detail-value">在线</text>
              </view>
            </view>
          </view>
          
          <view class="logout-button" bindtap="handleLogout">
            <text class="logout-text">退出</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 功能导航 -->
    <view class="function-nav">
      <view class="nav-header">
        <text class="nav-title">✨ 快捷功能</text>
        <text class="nav-subtitle">快速访问</text>
      </view>
      <view class="nav-grid">
        <view class="nav-item" bindtap="switchTab" data-tab="medical-record">
          <view class="nav-icon-wrapper medical-bg">
            <text class="nav-icon">📄</text>
          </view>
          <text class="nav-text">我的病历</text>
        </view>
        <view class="nav-item" bindtap="switchTab" data-tab="drug-info">
          <view class="nav-icon-wrapper drug-bg">
            <text class="nav-icon">💊</text>
          </view>
          <text class="nav-text">药品信息</text>
        </view>
        <view class="nav-item" bindtap="switchTab" data-tab="medication-check">
          <view class="nav-icon-wrapper check-bg">
            <text class="nav-icon">✅</text>
          </view>
          <text class="nav-text">用药打卡</text>
        </view>
        <view class="nav-item" bindtap="switchTab" data-tab="adverse-reaction">
          <view class="nav-icon-wrapper reaction-bg">
            <text class="nav-icon">⚠️</text>
          </view>
          <text class="nav-text">不良反应</text>
        </view>
      </view>
    </view>

    <!-- 快速提示 -->
    <view class="quick-tips">
      <view class="tips-header">
        <text class="tips-icon">💡</text>
        <text class="tips-title">温馨提示</text>
      </view>
      <view class="tips-content">
        <view class="tip-item">
          <view class="tip-icon">📝</view>
          <text class="tip-text">请及时记录用药情况</text>
        </view>
        <view class="tip-item">
          <view class="tip-icon">🚨</view>
          <text class="tip-text">如有不良反应请立即上报</text>
        </view>
        <view class="tip-item">
          <view class="tip-icon">👨‍⚕️</view>
          <text class="tip-text">如有疑问请联系您的主治医师</text>
        </view>
      </view>
    </view>

    <!-- 底部装饰 -->
    <view class="bottom-decoration">
      <view class="wave wave-1"></view>
      <view class="wave wave-2"></view>
    </view>
  </view>
</scroll-view>